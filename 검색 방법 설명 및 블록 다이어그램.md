## ðŸ“Š GraphRAG ì‹œìŠ¤í…œ ë‹¨ê³„ë³„ ë°ì´í„° íë¦„

| ë‹¨ê³„ | ì£¼ìš” ìž‘ì—… | ê¸°ìˆ ì  ìƒì„¸ ë° ë³´ì™„ ë‚´ìš© |
| :--- | :--- | :--- |
| **Step 0** | `main_chain` ì‹¤í–‰ ë° ìž…ë ¥ | ì§ˆë¬¸(`query`)ì´ ì‹œìŠ¤í…œ íŠ¸ë¦¬ê±°ê°€ ë˜ì–´ ì²´ì¸ì„ ê°€ë™í•¨. |
| **Step 1** | `rag_input` êµ¬ì„± | `question`ì€ ì›ë¬¸ ë³´ì¡´, `context`ëŠ” ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´í„°ì˜ ê²°ê³¼ë¬¼ë¡œ ë³‘ë ¬ ì¤€ë¹„í•¨. |
| **Step 2** | **Vector Search (Top 3)** | ì§ˆë¬¸ì˜ **ì˜ë¯¸(Semantics)**ë¥¼ íŒŒì•…í•´ ê´€ë ¨ ì˜í™” 3ê°œë¥¼ ì¶”ì¶œí•¨. |
| **Step 3** | **Graph Search 1 (movie_data)** | ì‹ë³„ëœ ì œëª©ìœ¼ë¡œ DBë¥¼ íƒìƒ‰í•˜ì—¬ ì •í˜• ë°ì´í„°(í‰ì , ë°°ìš° ID) í™•ë³´í•¨. |
| **Step 4** | **ID ì •ì œ ë° í™•ìž¥** | ë°°ìš° ID ì¤‘ë³µì„ ì œê±°í•˜ì—¬ 2ì°¨ íƒìƒ‰(í•„ëª¨ê·¸ëž˜í”¼) ìµœì í™” ìˆ˜í–‰í•¨. |
| **Step 5** | **Graph Search 2 (film_data)** | ì¸ë¬¼ ë…¸ë“œë¥¼ ê¸°ì ìœ¼ë¡œ ì¶œì—° ê´€ê³„ë¥¼ ì¶”ì í•˜ì—¬ ë°°ìš°ë³„ ë‹¤ë¥¸ ìž‘í’ˆ ì •ë³´ í™•ìž¥í•¨. |
| **Step 6** | **Formatting** | íŒŒíŽ¸í™”ëœ ë¦¬ìŠ¤íŠ¸ ë°ì´í„°ë¥¼ LLM ì¹œí™”ì ì¸ ìžì—°ì–´ í˜•íƒœì˜ ë¬¸ë§¥ìœ¼ë¡œ ë³‘í•©í•¨. |
| **Final** | **LLM Generation** | ì •ì œëœ `context`ì™€ ì›ë³¸ `question`ì„ ê²°í•©í•˜ì—¬ ìµœì¢… ë‹µë³€ ë„ì¶œí•¨. |
```mermaid

graph TD
    %% 1. Input Section
    A[User Query] --> B[Main Chain]
    
    %% 2. Orchestrator Section
    subgraph Orchestrator [movie_graph_search_orchestrator]
        B --> C{1. Vector Search}
        C -- "ìœ ì‚¬ ë¬¸ì„œ ê²€ìƒ‰" --> D[(Neo4j Vector Index)]
        D -- "Found Movie Titles" --> E{2. Graph Search 1}
        
        E -- "Cypher Query: Movie Info & Actor IDs" --> F[(Neo4j Graph DB)]
        F -- "Movie Data + Actor IDs" --> G{3. Graph Search 2}
        
        G -- "Cypher Query: Actor Filmography" --> F
        F -- "Other Movies Data" --> H[4. Format Context]
    end
    
    %% 3. LLM Generation Section
    H -- "Enriched Context" --> I[Prompt Template]
    A -- "Original Question" --> I
    I --> J[GPT-4o mini]
    J --> K[Final Answer]

    %% Styles
    style Orchestrator fill:#f9f9f9,stroke:#333,stroke-dasharray: 5 5
    style D fill:#e1f5fe,stroke:#01579b
    style F fill:#e1f5fe,stroke:#01579b
    style J fill:#fff3e0,stroke:#ff6f00

    ```
    