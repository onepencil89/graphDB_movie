단계,주요 작업,기술적 상세 및 보완 내용
Step 0,main_chain 실행 및 입력,사용자 질문(query)을 시스템 트리거로 사용하여 전체 체인 가동.
Step 1,rag_input 구성,"question은 원문 보존, context는 오케스트레이터의 출력값으로 병렬 준비."
Step 2,Vector Search (Top 3),질문의 **의미적 유사성(Semantics)**을 분석하여 관련 영화 3개를 추출.
Step 3,Graph Search 1 (movie_data),"식별된 영화 제목으로 DB 탐색 및 정형 데이터(평점, 배우 ID) 확보."
Step 4,ID 정제 및 확장,수집된 배우 ID의 중복을 제거하여 2차 탐색(필모그래피) 최적화 수행.
Step 5,Graph Search 2 (film_data),인물 노드를 기점으로 출연 관계를 추적하여 배우별 다른 작품 정보 확장.
Step 6,Formatting,리스트 형태의 파편화된 데이터를 LLM 친화적인 자연어 문맥으로 병합.
Final,LLM Generation,정제된 context와 원본 question을 결합하여 최종 답변 생성.

```mermaid

graph TD
    %% 1. Input Section
    A[User Query] --> B[Main Chain]
    
    %% 2. Orchestrator Section
    subgraph Orchestrator [movie_graph_search_orchestrator]
        B --> C{1. Vector Search}
        C -- "유사 문서 검색" --> D[(Neo4j Vector Index)]
        D -- "Found Movie Titles" --> E{2. Graph Search 1}
        
        E -- "Cypher Query: Movie Info & Actor IDs" --> F[(Neo4j Graph DB)]
        F -- "Movie Data + Actor IDs" --> G{3. Graph Search 2}
        
        G -- "Cypher Query: Actor Filmography" --> F
        F -- "Other Movies Data" --> H[4. Format Context]
    end
    
    %% 3. LLM Generation Section
    H -- "Enriched Context" --> I[Prompt Template]
    A -- "Original Question" --> I
    I --> J[GPT-4o mini]
    J --> K[Final Answer]

    %% Styles
    style Orchestrator fill:#f9f9f9,stroke:#333,stroke-dasharray: 5 5
    style D fill:#e1f5fe,stroke:#01579b
    style F fill:#e1f5fe,stroke:#01579b
    style J fill:#fff3e0,stroke:#ff6f00

    ```
    